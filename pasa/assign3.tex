\documentclass[8pt]{article}
\usepackage[UTF8]{ctex}
\usepackage[a4paper]{geometry}

\usepackage{amsthm,amsmath,amssymb}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{tabularx}
\usepackage{color}
\usepackage{hyperref}
\usepackage{ulem}
\usepackage{multirow}
\usepackage[cache=false]{minted}
\hypersetup{
	colorlinks=true,
	linkcolor=blue
}

\usepackage{appendix}
\geometry{a4paper,centering,scale=0.8}
\geometry{left=2.0cm, right=2.0cm, top=2.5cm, bottom=2.5cm}
\usepackage[format=hang,font=small,textfont=it]{caption}
\usepackage[nottoc]{tocbibind}

\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{amssymb}
\usepackage{extarrows}
\usepackage{qcircuit}
\usepackage{fancyhdr}
\usepackage{cleveref}

\usepackage{tikz}  
\usetikzlibrary{arrows.meta}%画箭头用的包

\makeatletter
\def\@maketitle{%
	\newpage
	\begin{center}%
		\let \footnote \thanks
		{\LARGE \@title \par}%
		\vskip 1.5em%
		{\large
			\lineskip .5em%
			\begin{tabular}[t]{c}%
				\@author
			\end{tabular}\par}%
		\vskip 1em%
		{\large \@date}%
	\end{center}%
	\par
	\vskip 1.5em}
\makeatother

\newtheoremstyle{compact}%
{3pt}{3pt}%
{}{}%
{\bfseries}{\textcolor{red}{.}}%  % Note that final punctuation is omitted.
{.5em}{\mbox{\textcolor{red}{\thmname{#1}\thmnumber{ #2}}\thmnote{ (\textcolor{blue}{#3})}}}
\theoremstyle{compact}
\newtheorem{innercustomgeneric}{\customgenericname}
\providecommand{\customgenericname}{}
\newcommand{\newcustomtheorem}[2]{%
	\newenvironment{#1}[1]
	{%
		\renewcommand\customgenericname{#2}%
		\renewcommand\theinnercustomgeneric{##1}%
		\innercustomgeneric
	}
	{\endinnercustomgeneric}
}

\DeclareMathOperator{\card}{card}

\newtheorem{theorem}{定理}
\newtheorem{lemma}{引理}
\newtheorem{definition}{定义}
\newtheorem{proposition}{命题}
\newtheorem{corollary}{推论}
\newtheorem{example}{例}
\newtheorem{claim}{声明}
\newtheorem{remark}{注}
\newtheorem{thesis}{论点}
\newtheorem{Proof}{证明}

\def\obj#1{\textbf{\uline{#1}}}
\def\num#1{\textnormal{\textbf{\mbox{\textcolor{blue}{(#1)}}}}}
\def\le{\leqslant}
\def\ge{\geqslant}
\def\im{\text{im }}
\def\P#1{\mathbb{P}\left({#1}\right)}
\def\e{\mathrm{e}}
\def\E#1{\mathbb{E}\left[{#1}\right]}
\def\Var#1{\text{Var}\left[{#1}\right]}


\title{\heiti\zihao{2} 概率统计(A)课程作业: 多元随机变量及其分布}
\author{\kaishu\zihao{-3} 周书予\\2000013060@stu.pku.edu.cn}

\CTEXoptions[today=old]
\date{\today}

\usepackage{totpages}
\begin{document}


\fancypagestyle{plain}{
	\fancyhf{}
	\lhead{概率统计(A)}
	\chead{2022 Spring}
	\rhead{多元随机变量及其分布}
	\cfoot{第 \thepage 页, 共 \pageref{TotPages} 页}
}
\pagestyle{plain}

\crefname{theorem}{定理}{定理}
\crefname{lemma}{引理}{引理}
\crefname{figure}{图}{图}
\crefname{table}{表}{表}	
\maketitle

\section{}
\subsection{}
$$\begin{cases}
		\P{XY \neq 0} = a + c + 0.2 = 0.4\\
		\P{X \le 0 | Y \le 0} = \frac{a + b + 0.1}{a + b + 0.3} = \frac23\\
		a + b + c + 0.6 = 1
	\end{cases}
	\Rightarrow
	\begin{cases}
		a = 0.1 \\ b = 0.2 \\ c = 0.1
	\end{cases}$$
\subsection{}
	\begin{center}
	\begin{tabular}{c|cccc}
		$X / Y$ & $-1$ & $0$ & $1$ & $\P{X = x_i}$ \\
		\hline
		$-1$ & $0.1$ & $0$   & $0.2$ & 0.3\\
		$0$  & $0.1$ & $0.2$ & $0.1$ & 0.4\\
		$1$  & $0$   & $0.2$ & $0.1$ & 0.3\\
		$\P{Y = y_j}$ & 0.2 & 0.4 & 0.4 &
	\end{tabular}
	\end{center}
\subsection{}
\begin{center}
	\begin{tabular}{c|ccccc}
		$z_k$ & -2 & -1 & 0 & 1 & 2\\
		\hline
		$\P{X + Y = z_k}$ & 0.1 & 0.1 & 0.4 & 0.3 & 0.1
	\end{tabular}
\end{center}

\section{}
\subsection{}
	\begin{equation}
		1 = \int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f_{X, Y}(x, y)\text dy \text dx = \int_{-1}^{1}\int_{-1}^{1}C(1 + xy)\text dy \text dx = \int_{-1}^{1}2C\text dx = 4C
	\end{equation}
	故 $C = \frac14$.
	\begin{equation}
		\begin{split}
			f_X(x) = \int_{-\infty}^{+\infty}f_{X, Y}(x, y)\text dy = \begin{cases}
				\frac12, & |x| < 1\\
				0, & |x| \ge 1
			\end{cases}\\
			f_Y(y) = \int_{-\infty}^{+\infty}f_{X, Y}(x, y)\text dx = \begin{cases}
				\frac12, & |y| < 1\\
				0, & |y| \ge 1
			\end{cases}
		\end{split}
	\end{equation}
	\subsection{} $X, Y$ 不独立, 因为 $f_{X, Y}(x, y) = f_X(x) \cdot f_Y(y)$ 对几乎所有 $(x, y)$ 都不成立.
	\subsection{}
	\begin{equation}
		\begin{split}
			F_{X^2, Y^2}(x, y) &= \P{-\sqrt x \le X \le \sqrt x, -\sqrt y \le Y \le \sqrt y} = \int_{-\sqrt x}^{\sqrt x}\int_{-\sqrt y}^{\sqrt y}f_{X, Y}(t_1, t_2)\text dt_1 \text dt_2 = \min\{\sqrt x, 1\} \cdot \min\{\sqrt y, 1\}\\
			F_{X^2}(x) &= \P{-\sqrt x \le X \le \sqrt x} = \int_{-\sqrt x}^{\sqrt x}f_X(t)\text dt = \min\{\sqrt x, 1\}\\
			F_{Y^2}(y) &= \P{-\sqrt y \le Y \le \sqrt y} = \int_{-\sqrt y}^{\sqrt y}f_Y(t)\text dt = \min\{\sqrt y, 1\}
		\end{split}
	\end{equation}
	因此 $X^2, Y^2$ 相互独立.

\section{}
\subsection{}
\begin{equation}
	f_{X, Y}(x, y) = \frac{1}{2\pi\sigma_1\sigma_2\sqrt{1 - \rho^2}} \exp\left[\frac{-1}{2(1 - \rho^2)}\left(\frac{(x - \mu_1)^2}{\sigma_1^2} - 2\rho\frac{(x - \mu_1)(y - \mu_2)}{\sigma_1\sigma_2} + \frac{(y - \mu_2)^2}{\sigma_2^2}\right)\right]
\end{equation}
其中 $\mu_1 = 4, \mu_2 = 3, \sigma_1^2 = 1, \sigma_2^2 = 2$.
\subsection{}
\begin{equation}
	f_X(x) = \frac{1}{\sqrt{2\pi}\sigma_1}\exp\left(-\frac{(x - \mu_1)^2}{2\sigma_1^2}\right) = \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{(x - 4)^2}{2}\right)
\end{equation}
\subsection{}
\begin{equation}
	f_{Y|X}(y | x) = \frac{1}{\sqrt{2\pi}\sigma_2\sqrt{1 - \rho^2}}\exp\left[ -\frac{\left(y - (\mu_2 + \rho\frac{\sigma_2}{\sigma_1}(x - \mu_1))\right)^2}{2(1 - \rho^2)\sigma_2^2} \right] = \frac{1}{\sqrt{2\pi}}\exp\left[ -\frac{\left(y + x - 7\right)^2}{2} \right]
\end{equation}


\section{}
令 $Z = X + Y$. $X \sim NB(1, p) \Rightarrow \P{X = r} = p(1-p)^{r-1}, Y \sim NB(2, p) \Rightarrow \P{Y = r} = (r-1)p^2(1-p)^{r-2}$.

\begin{equation}
	\begin{split}
		\P{Z = r} &= \sum_{k=0}^{r-1}\P{X = k} \P{Y = r - k} \\
		&= \sum_{k=0}^{r-1}p(1-p)^{k-1} \cdot (r-k-1)p^2(1-p)^{r-k-2}\\
		&= p^3(1-p)^{r-3}\sum_{k=0}^{r-1}(r-k-1)\\
		&= \binom{r-1}{2}p^3(1-p)^{r-3}
	\end{split}
\end{equation}
从而 $Z \sim NB(3, p)$.

\section{}
\begin{equation}
	\begin{split}
		\P{Y = k} &= \sum_{x \ge k} \P{X = x} \binom{x}{k}\left(\frac13\right)^k\left(\frac23\right)^{x-k}\\
		&= \sum_{x \ge k} \e^{-6}\frac{6^x}{x!} \binom{x}{k}\left(\frac13\right)^k\left(\frac23\right)^{x-k}\\
		&= \e^{-2}\frac{2^k}{k!}\sum_{x - k \ge 0} \e^{-4}\frac{4^{x-k}}{(x-k)!}\\
		&= \e^{-2}\frac{2^k}{k!}
	\end{split}
\end{equation}
从而 $Y \sim \pi(2)$. $\arg\max\limits_k \P{Y = k} = \{1, 2\}$.

\section{}
\subsection{}
\begin{equation}
	\P{X = x, Z = z} = \begin{cases}
		\P{X = x}\P{y = z}, & x < z\\
		\P{X = x}\P{y \le x}, & x = z\\
		0, & x > z
	\end{cases}
	= \begin{cases}
		p^2(1-p)^{x + z}, & x < z\\
		p(1-p)^{z}(1 - (1-p)^{z+1}), & x = z\\
		0, & x > z
	\end{cases}
\end{equation}
\subsection{}
注意到
\begin{equation}
	\begin{split}
		\P{Z = z} &= \P{Z \le z} - \P{Z \le z - 1} \\
		&= \left[\P{X \le z}\right]^2 - \left[\P{X \le z - 1}\right]^2 \\
		&= [1 - (1-p)^{z+1}]^2 - [1 - (1-p)^{z}]^2\\
		&= p(1-p)^z(2 - (2 - p)(1 - p)^z)
	\end{split}
\end{equation}
因此
\begin{equation}
	\P{X = x | Z = z} = \frac{\P{X = x, Z = z}}{\P{Z = z}} = \begin{cases}
		\frac{p(1-p)^x}{2 - (2-p)(1-p)^{z}}, & x < z \\
		\frac{1 - (1-p)^{z+1}}{2 - (2-p)(1-p)^{z}}, & x = z\\
		0, & x > z
	\end{cases}
\end{equation}

\section{}
\label{t7}
考虑对 $n$ 归纳. 当 $n = 1$ 时, $f_{Y_1}(y) = \begin{cases}
	\lambda\e^{-\lambda y}, & y > 0\\
	0, & y \le 0
\end{cases}$ 恰好是指数分布, 故成立.

假设 $f_{Y_k}(y) = \begin{cases}
	y^{k-1}\lambda^k\e^{-\lambda y} / (k-1)!, & y > 0\\
	0, & y \le 0
\end{cases}$ 成立, 考虑计算$Y_{k+1} = Y_k + X_{k+1}$ 的密度分布, 当 $y > 0$ 时, 有

\begin{equation}
	\begin{split}
		f_{Y_{k+1}}(y) &= \int_{-\infty}^{+\infty}f_{Y_k}(t)f_{X}(y-t)\text dt = \int_{0}^{y}\frac{t^{n-1}\lambda^n\e^{-\lambda t}}{(n-1)!}\cdot \lambda \e^{-\lambda(y-t)}\text dt\\
		&= \frac{\lambda^{n+1}\e^{-\lambda x}}{(n-1)!} \frac{t^n}{n}\bigg|_{0}^{y} = \frac{y^n\lambda^{n+1}\e^{-\lambda x}}{n!}
	\end{split}
\end{equation}

而显然 $f_{Y_{k + 1}}(y) = 0 \ (y \le 0)$, 因此结论对于 $k+1$ 也成立, 从而对任意 $n$ 均成立.

\section{}

\subsection{}

\iffalse
\begin{equation}
	\begin{split}
		F_{Z, W}(z, w) &= \P{X^2 \le z, X + Y \le w} \\
		&= \int_{0}^{w} \int_{0}^{\min(w - y, \sqrt z)} f_{X, Y}(x, y) \text dx \text dy\\
		&= \int_{0}^{w} \int_{0}^{\min(w - y, \sqrt z)} \lambda^2\e^{-\lambda(x + y)} \text dx \text dy\\
		&= \begin{cases}
			\int_{0}^{w} \int_{0}^{w - y} \lambda^2\e^{-\lambda(x + y)} \text dx \text dy, & \sqrt z > w\\
			\P{X \le \sqrt z}\P{Y \le w - \sqrt z} + \int_{w - \sqrt z}^{w} \int_{0}^{w - y} \lambda^2\e^{-\lambda(x + y)} \text dx \text dy, & \sqrt z \le w
		\end{cases} \\
		&= \begin{cases}
			1 - w\lambda\e^{-\lambda w} - \e^{-\lambda w}, & \sqrt z > w\\
			1 - \sqrt z\lambda\e^{-\lambda w} - \e^{-\lambda \sqrt z}, & \sqrt z \le w
		\end{cases}\\
		f_{Z, W}(z, w) &= \frac{\partial^2 F_{Z, W}(z, w)}{\partial z \partial w} = \begin{cases}
			0, & \sqrt z > w\\
			\frac{\lambda^2\e^{-\lambda w}}{2\sqrt z}, & \sqrt z \le w
		\end{cases}
	\end{split}
\end{equation}
\fi
\begin{equation}
	\begin{split}
		f_{Z, W}(z, w) &= f_{X, Y}(x, y)\left|\frac{\partial(x, y)}{\partial(z, w)}\right|\\
		&= f_{X, Y}(x, y) \begin{vmatrix}
			\frac{1}{2\sqrt z} & 1 \\ 0 & 1
		\end{vmatrix}\\
		&= \begin{cases}
			\frac{\lambda^2\e^{-\lambda(x + y)}}{2\sqrt z}, & x \ge 0, y \ge 0\\
			0, & \text{otherwise}
		\end{cases}\\
		&= \begin{cases}
			\frac{\lambda^2\e^{-\lambda w}}{2\sqrt z}, & 0 \le \sqrt z \le w\\
			0, & \text{otherwise}
		\end{cases}
	\end{split}
\end{equation}

\subsection{}
根据 \cref{t7} 有 $f_W(w) = w\lambda^2\e^{-\lambda w}$, 故
\begin{equation}
	\begin{split}
		f_{Z | W}(z | w) = \frac{f_{Z, W}(z, w)}{f_W(w)} = \frac{f_{Z, W}(z, w)}{w\lambda^2\e^{-\lambda w}} = \begin{cases}
			\frac{1}{2\sqrt z w}, & 0 \le \sqrt z \le w\\
			0, & \text{otherwise}
		\end{cases}
	\end{split}
\end{equation}

\section{}
\subsection{}
\begin{equation}
	\begin{split}
		F_n(x) = \P{Y_n \le x} = 1 - \P{Y_n > x} &= 1 - \prod_{i=1}^{n}\P{X_i > x} = \begin{cases}
			0, & x < 0\\
			1 - (1 - x)^n, & 0 \le x < 1\\
			1, & x \ge 1
		\end{cases}\\
		\lim_{n \to \infty}F_n(x) &= \begin{cases}
			0, & x \le 0 \\
			1, & x > 0
		\end{cases}
	\end{split}
\end{equation}
\subsection{}
\begin{equation}
	\begin{split}
		\P{Z > 3} &= \P{X_1 \le 1 \wedge X_1 + X_2 \le 1 \wedge X_1 + X_2 + X_3 \le 1}\\
		&= \int_{0}^{1}\int_{0}^{1 - x_1}\int_{0}^{1 - x_1 - x_2}\text dx_3 \text dx_2 \text dx_1\\
		&= \int_{0}^{1}\int_{y_1}^{1}\int_{y_2}^{1}\text dy_3 \text dy_2 \text dy_1
	\end{split}
\end{equation}

\begin{lemma}
	对于 $n \in \mathbb N^+$ 和 $L > 0$, 有\begin{equation}
		\int_{0}^{L}\int_{y_1}^{L}\cdots\int_{y_{n-1}}^{L}\text dy_n\cdots\text dy_2\text dy_1 = \frac{L^n}{n!}
	\end{equation}
\end{lemma}
\begin{proof}
	考虑对 $n$ 作归纳. $n = 1$ 时显然成立. 假设结论对于 $k$ 成立, 则
	\begin{equation}
		\begin{split}
			\int_{0}^{L}\left[\int_{y_1}^{L}\cdots\int_{y_k}^{L}\text dy_{k+1}\cdots\text dy_2\right]\text dy_1 &= \int_{0}^{L}\left[\int_{0}^{L - y_1}\cdots\int_{z_k}^{L - y_1}\text dz_{k+1}\cdots\text dz_2\right]\text dy_1\\
			&= \int_{0}^{L}\frac{(L - y_1)^k}{k!}\text dy_1\\
			&= -\frac{(L - y_1)^{k+1}}{(k+1)!}\bigg|_{0}^{L}\\
			&= \frac{L^{k+1}}{(k+1)!}
		\end{split}
	\end{equation}
	结论对 $k + 1$ 亦成立, 从而对所有正整数 $n$ 均成立.
\end{proof}

结合上述引理, 可知 $\P{Z > 3} = \frac16$.

\section{}
\subsection{}
因为 $X_1, X_2, X_3$ 是独立随机变量, 故 $f_{X_1, X_2, X_3}(x_1, x_2, x_3) = f_{X_1}(x_1)f_{X_2}(x_2)f_{X_3}(x_3) = (2\pi)^{-\frac32}\exp\left(-\frac{x_1^2 + x_2^2 + x_3^2}{2}\right)$.
\subsection{}
\begin{equation}
	\begin{split}
		f_{Z, X_2, X_3}(z, x_2, x_3) &= f_{X_1, X_2, X_3}(x_1, x_2, x_3)\left|\frac{\partial(z, x_2, x_3)}{\partial(x_1, x_2, x_3)}\right|^{-1}\\
		&= f_{X_1, X_2, X_3}(x_1, x_2, x_3)\begin{vmatrix}
			\frac{1}{\sqrt{1 + x_3^2}} & \frac{x_3}{\sqrt{1 + x_3^2}} & \dfrac{x_3}{\sqrt{x_3^2+1}}-\dfrac{x_3\left(x_1+x_2x_3\right)}{\left(x_3^2+1\right)^\frac{3}{2}}\\
			0&1&0\\0&0&1
		\end{vmatrix}^{-1}\\
		&= (2\pi)^{-\frac32}\sqrt{1+x_3^2}\exp\left[-\frac12\left(\left(z\sqrt{1+x^3}-x_2x_3\right)^2+x_2^2+x_3^2\right)\right]
	\end{split}
\end{equation}
\subsection{}
\begin{equation}
	\begin{split}
		f_{Z, X_3}(z, x_3) &= \int_{-\infty}^{+\infty}f_{Z, X_2, X_3}(z, x_2, x_3)\text dx_2\\
		&= \int_{-\infty}^{+\infty} (2\pi)^{-\frac32}\sqrt{1+x_3^2}\exp\left[-\frac12\left(\left(z\sqrt{1+x^3}-x_2x_3\right)^2+x_2^2+x_3^2\right)\right]\text dx_2\\
		&= \int_{-\infty}^{+\infty} (2\pi)^{-\frac32}\sqrt{1+x_3^2}\exp\left[-\frac12\left(\left(x_2\sqrt{1+x^3}-zx_3\right)^2+z^2+x_3^2\right)\right]\text dx_2\\
		&= \frac{1}{2\pi}\exp\left[-\frac12(z^2 + x_3^2)\right]\int_{-\infty}^{+\infty}\frac{\sqrt{1 + x_3^2}}{\sqrt{2\pi}}\exp\left[-\frac12\left(\sqrt{1+x_3^2}x_2 - zx_3\right)^2\right]\text dx_2\\
		&= \frac{1}{2\pi}\exp\left[-\frac12(z^2 + x_3^2)\right]
	\end{split}
\end{equation}

可以发现 $f_Z(z) = \int_{-\infty}^{+\infty}f_{Z, X_3}(z, x_3)\text dx_3 = \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{z^2}{2}\right)$ 故 $Z \sim \mathcal N(0, 1)$, 而 $f_{Z, X_3}(z, x_3) = f_Z(z)f_{X_3}(x_3)$ 说明 $Z, X_3$ 是独立随机变量, 因此 $Z, X_3 \sim \text{i.i.d. } \mathcal N(0, 1)$.

\end{document}

